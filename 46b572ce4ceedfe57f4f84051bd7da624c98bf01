{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "987fa5fd_3fc14056",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000842
      },
      "writtenOn": "2021-09-07T16:38:43Z",
      "side": 1,
      "message": "Hello,\n\nUsing the latest gn build (which includes this patch) generates this error on most platforms when used on V8:\n```\nERROR at //testing/gmock/BUILD.gn:11:1: Dependency not allowed.\nsource_set(\"gmock\") {\n^--------------------\nThe item //testing/gmock:gmock\ncan not depend on //third_party/googletest:gtest_config\nbecause it is not in //third_party/googletest:gtest_config\u0027s visibility list: [\n  //third_party/googletest:*\n]\n```\nAre there additional changes that need to be made on the chromium/v8 side?",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ddb00d3d_c1b643fa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000313
      },
      "writtenOn": "2021-09-07T16:44:38Z",
      "side": 1,
      "message": "Hi Milad,\nI\u0027d recommend adding \"//testing/gmock/*\" to the visibility list for //third_party/googletest:gtest_config. After doing this you may see more errors that look like this, and you\u0027ll need to do more of the same.\n\n+digit FYI we may have similar issues blocking our next roll.",
      "parentUuid": "987fa5fd_3fc14056",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6207bfb9_b8de953a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000047
      },
      "writtenOn": "2021-09-07T16:56:48Z",
      "side": 1,
      "message": "Yes, there will be some errors, I had a look at chrome prior to this and at least in ine Linux build, there weren\u0027t that many (3) but there may be some extras on othr platforms, and in standalone builds. webrtc in particular\n\nI started listing them in https://bugs.chromium.org/p/gn/issues/detail?id\u003d252, one should be fixed already.",
      "parentUuid": "ddb00d3d_c1b643fa",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f8433e63_837b371d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000842
      },
      "writtenOn": "2021-09-07T17:18:43Z",
      "side": 1,
      "message": "Thanks Shai for the suggestion.\n\n@Tomasz Your Chromium patch at http://crrev.com/c/3139927 does fix the issue. I will need to also port it to V8:\nhttps://chromium.googlesource.com/v8/v8.git/+/refs/heads/main/testing/gmock/BUILD.gn\n\nThanks for your help.",
      "parentUuid": "6207bfb9_b8de953a",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ac44f269_af0ec457",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000102
      },
      "writtenOn": "2021-09-11T01:54:33Z",
      "side": 1,
      "message": "What\u0027s the incremental rollout plan for this? As-is, it makes it impossible to roll GN in Chromium: https://chromium-review.googlesource.com/c/chromium/src/+/3155644",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e2ed4aa0_7bc1133c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000047
      },
      "writtenOn": "2021-09-11T11:17:25Z",
      "side": 1,
      "message": "I had a look prior to making this gn change and it seemed like there\u0027s only a handful of violations of this in chromium. Two I managed to get fixed already (see gn bug 252), the webrtc one is a bit less obvious due to webrtc\u0027s... opinionated approach to gn, aka no public_deps. I should have something workable next week.",
      "parentUuid": "ac44f269_af0ec457",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "596db41e_199a9fec",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000047
      },
      "writtenOn": "2021-09-13T13:24:20Z",
      "side": 1,
      "message": "Two places needed fixing still: webrtc and a mac build template. WIP reviews in https://chromium-review.googlesource.com/c/chromium/src/+/3158044 and chain there (git cl didn\u0027t like me trying to base on the failed roll, so I had to DIY it to get things built on trybots).",
      "parentUuid": "e2ed4aa0_7bc1133c",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2b6db8d0_3a2a5b27",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000102
      },
      "writtenOn": "2021-09-13T16:41:39Z",
      "side": 1,
      "message": "Another unrelated question about this change. It complains about LLVM\u0027s gn build like so:\n\n```\n[0/1] Regenerating ninja files\nERROR at //llvm/utils/gn/build/write_vcsrevision.gni:21:3: Dependency not allowed.\n  action(target_name) {\n  ^--------------------\nThe item //clang/lib/Basic:write_vcsversion\ncan not depend on //clang/lib/Basic:write_vcsrevision_config\nbecause it is not in //clang/lib/Basic:write_vcsrevision_config\u0027s visibility list: [\n  //clang/lib/Basic:write_vcsrevision\n]\n```\n\nhttps://github.com/llvm/llvm-project/blob/main/llvm/utils/gn/secondary/clang/lib/Basic/BUILD.gn#L6 adds `//clang/lib/Basic:write_vcsrevision` to the config\u0027s visibility list as far as I can tell, and this tries to forward the visibility https://github.com/llvm/llvm-project/blob/main/llvm/utils/gn/build/write_vcsrevision.gni#L49\n\nIs that working as expected? Do I have to change my build file? If so, how? Or is this a bug?\n",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e10caf81_5bfbd3bb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000102
      },
      "writtenOn": "2021-09-13T16:46:02Z",
      "side": 1,
      "message": "Looking at the error message a bit closer, `The item //clang/lib/Basic:write_vcsversion is not in [ //clang/lib/Basic:write_vcsrevision ]` suggests I typod \"write_vcsrevision\" for \"write_vcsversion\". Thanks for this diagnostic ðŸ˜Š",
      "parentUuid": "2b6db8d0_3a2a5b27",
      "revId": "46b572ce4ceedfe57f4f84051bd7da624c98bf01",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    }
  ]
}