{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "49fa6ad9_150843e7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000067
      },
      "writtenOn": "2024-09-02T10:03:03Z",
      "side": 1,
      "message": "Thanks, this look good to me. This breaks the Fuchsia build, but I have uploaded https://fuchsia-review.googlesource.com/c/fuchsia/+/1111713 to set `no_stamp_files \u003d false` in our `.gn` files and this seems to work around this for now. We\u0027ll have time to cleanup our actions to create depfile parent directories later.\n\nCan I ask you to add one specific unit-test that verifies the Ninja output when `no_stamp_files \u003d false` though? This may help catch regressions in the future.",
      "revId": "517e86f8b9b00b7e1ced36a44ea8a0f445b4e204",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "621373ef_26f6601d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000030
      },
      "writtenOn": "2024-09-03T08:40:01Z",
      "side": 1,
      "message": "I added one unittests in src/gn/ninja_target_writer_unittest.cc. \n\nDo you have any ETA to remove `no_stamp_files \u003d false` in fuchsia build? I\u0027d like to remove the variable and conditional code when it seems stable on chromium.",
      "parentUuid": "49fa6ad9_150843e7",
      "revId": "517e86f8b9b00b7e1ced36a44ea8a0f445b4e204",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a647dfb3_d64faf78",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000067
      },
      "writtenOn": "2024-09-03T08:52:33Z",
      "side": 1,
      "message": "Thank you!\n\nNo ETA yet, but I hope to convince upstream Ninja to revive https://github.com/ninja-build/ninja/pull/1849 since this will get rid of our issues.\n\nOtherwise, cleanup up our build may take some time, as the failures are flaky.\nThe reason for this is that we have many sets of actions that write to the same `target_out_dir`, and breakage happens depending on which command is run first by Ninja (even in clean builds), so problematic actions could go unnoticed for a very long time.",
      "parentUuid": "621373ef_26f6601d",
      "revId": "517e86f8b9b00b7e1ced36a44ea8a0f445b4e204",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7534d8f7_7de40fcc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000030
      },
      "writtenOn": "2024-09-05T05:39:10Z",
      "side": 1,
      "message": "Oh, I thought fuchsia forked ninja for their own usage. But it is not true now?\n\nAnyway, if the PR helps to remove no_stamp_files config, I\u0027ll ask Nico to merge the PR.",
      "parentUuid": "a647dfb3_d64faf78",
      "revId": "517e86f8b9b00b7e1ced36a44ea8a0f445b4e204",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "515cee29_212313ab",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000067
      },
      "writtenOn": "2024-09-05T09:53:30Z",
      "side": 1,
      "message": "It is true, but we are adamant to keep close to upstream Ninja as much as possible (i.e. we only add extra features, we rebase our patches frequently over upstream).\n\nThis can be fixed in our fork, but then it becomes impossible to use upstream Ninja with our build system (which I do frequently to verify correctness / performance differences).\n\nAlso note that other GN-based builds might be impacted by the exact same issue if this is not fixed in upstream Ninja.\n\nThe upstream PR is now at https://github.com/ninja-build/ninja/pull/2492, it is similar to the old https://github.com/ninja-build/ninja/pull/1849, with an additionnal regression test. Hopefully this will be accepted soon, and we will have that in our fork.\n\nNote that I suspect it will take time for the new upstream Ninja release to happen, which means you may want to wait for that to happen to completely remove stamp file support from GN (or use a Ninja minimum version in the generated build.ninja file that reflects the minimal requirements).",
      "parentUuid": "7534d8f7_7de40fcc",
      "revId": "517e86f8b9b00b7e1ced36a44ea8a0f445b4e204",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8b60bada_cc41d847",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000030
      },
      "writtenOn": "2024-09-06T03:44:37Z",
      "side": 1,
      "message": "I see. Anyway, thank you for creating new PR.",
      "parentUuid": "515cee29_212313ab",
      "revId": "517e86f8b9b00b7e1ced36a44ea8a0f445b4e204",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    }
  ]
}