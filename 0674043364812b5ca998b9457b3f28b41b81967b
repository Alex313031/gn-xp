{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "45c5f7bf_e29a9149",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000070
      },
      "writtenOn": "2020-11-30T14:02:27Z",
      "side": 1,
      "message": "+brettw\n\nDo you think we should add some information in docs/faq.md about filter_include, filter_exclude, string_replace, ... functions? Or information on how to deal with conditional inclusion of sources file per platform?\n\nI think recommending to use filter_include/filter_exclude in `gn help set_sources_assignment_filter` is not really helpful (for once, it will disappear once the function is removed), especially when the recommended way to filter is to just use conditional assignments.\n\nWDYT?",
      "revId": "0674043364812b5ca998b9457b3f28b41b81967b",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fc3c3788_9258db5e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000070
      },
      "writtenOn": "2021-08-30T08:25:52Z",
      "side": 1,
      "message": "set_source_assignment_filter has been removed.\n\nI think this CL is now obsolete and can be closed.",
      "revId": "0674043364812b5ca998b9457b3f28b41b81967b",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aea8afb8_f4a70f3b",
        "filename": "docs/reference.md",
        "patchSetId": 2
      },
      "lineNbr": 3059,
      "author": {
        "id": 1000070
      },
      "writtenOn": "2020-11-27T14:06:51Z",
      "side": 1,
      "message": "This file is autogenerated. The change needs to be done to src/gn/functions.cc instead.\n\nAlso, the recommended way to perform filtering is to explicitly use check when assigning source files to sources.\n\nThat is if you have the following code:\n\n  global_source_assignment_filter \u003d []\n  if (!is_win) { global_sources_assignment_filter +\u003d [ \"*_win.*\" ] }\n  if (!is_mac) { global_sources_assignment_filter +\u003d [ \"*_mac.*\" ] }\n  ...\n  set_sources_assignment_filter(global_sources_assignment_filter)\n  ...\n\n  sources_set(\"foo\") {\n    sources \u003d [\n      \"foo.h\",\n      \"foo_win.cc\",\n      \"foo_mac.cc\",\n    ]\n  }\n\nthen the recommended way to convert is the following:\n\n  sources_set(\"foo\") {\n    sources \u003d [ \"foo.h\" ]\n    if (is_win) { sources +\u003d [ \"foo_win.cc\" ] }\n    if (is_mac) { sources +\u003d [ \"foo_mac.cc\" ] }\n  }\n\nSo I don\u0027t think we want to recommend using filter_exclude here.",
      "range": {
        "startLine": 3059,
        "startChar": 10,
        "endLine": 3059,
        "endChar": 18
      },
      "revId": "0674043364812b5ca998b9457b3f28b41b81967b",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5beada41_4d2c9423",
        "filename": "docs/reference.md",
        "patchSetId": 2
      },
      "lineNbr": 3059,
      "author": {
        "id": 1000962
      },
      "writtenOn": "2020-11-27T14:15:03Z",
      "side": 1,
      "message": "Ah - this is my first try at committing something to the GN project. Thanks for letting me know that this file is generated. \n\nFor source includes, I totally agree with your standpoint. There could perhaps be other more complex use cases of set_sources_assignment_filter. For example it could be used in tandem with get_target_outputs inside of a template - and that would make it hard to replace with an explicit list. \n\nWould a corrected version of this patch be accepted, or should I drop it?",
      "parentUuid": "aea8afb8_f4a70f3b",
      "range": {
        "startLine": 3059,
        "startChar": 10,
        "endLine": 3059,
        "endChar": 18
      },
      "revId": "0674043364812b5ca998b9457b3f28b41b81967b",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a92ce04_b9ff668a",
        "filename": "docs/reference.md",
        "patchSetId": 2
      },
      "lineNbr": 3059,
      "author": {
        "id": 1000070
      },
      "writtenOn": "2020-11-27T14:49:08Z",
      "side": 1,
      "message": "Using set_sources_assignment_filter to filter other things that sources was already a hack that was not really recommended. It is true that filter_exclude was added to properly support that use case.\n\nThe function set_sources_assignment_filter will eventually be removed. When this happen, the documentation will also be removed. I think a better location for the information may be docs/faq.md in a new point. Something like:\n\n  ## How to work with list/strings?\n\n  gn provides some intrinsics functions to perform operations on list and\n  strings.\n\n  -   `filter_include` takes a list of strings and a list of patterns and\n      returns a list with all the elements matching any of the patterns\n\n  -   `filter_exclude` takes a list of strings and a list of patterns and\n      returns a list with all the elements matching none of the patterns\n\n  -  `string_replace` takes a string, a pattern and a substitution and\n     returns a new string with all occurrence of the pattern replaced by\n     the substitution\n\n  -  `foreach` allow you to iterate over a list.\n\n  For more information, consult `gn help $function`.\n\nWhat do you think?\n\nI think brettw should be involved in the discussion (since they were initially reluctant to adding those functions, so I\u0027m not sure whether adding emphasis on them would be accepted).",
      "parentUuid": "5beada41_4d2c9423",
      "range": {
        "startLine": 3059,
        "startChar": 10,
        "endLine": 3059,
        "endChar": 18
      },
      "revId": "0674043364812b5ca998b9457b3f28b41b81967b",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "10e65269_27ef25ca",
        "filename": "docs/reference.md",
        "patchSetId": 2
      },
      "lineNbr": 3059,
      "author": {
        "id": 1000962
      },
      "writtenOn": "2020-11-27T15:38:04Z",
      "side": 1,
      "message": "My experience with GN is perhaps still a bit too small to give strong opinions on this matter, but I\u0027ll at least try and reflect on it. \n\nI can see how adding information on these functions inside the FAQ might increase usage of these functions going forward. It is perhaps up to you as maintainers to decide on if you want to see more usage of \"filter_*\" functions since usage of them possibly makes them harder to deprecate and/or change. \n\nAny which way you as maintainers decide upon going forward, it is nice to reference intended replacements/best practice functions and/or patterns for now deprecated functionality. If there is no replacement pattern and the use case is no longer an intended one, that might be worth a mention as well. \n\nMy intention with this patch was to explicitly state that there is a function which can provide similar functionality. The intention was to avoid unnecessary work for developers with existing code bases that have been previously using set_sources_assignment_filter, informing existing them of an alternative method now that the function behavior is changed in preparation of removal.  \n\nThanks for including me in your thought process. Feel free make a decision that fits you as maintainers regarding this. If you decide that these functions provide a usage pattern that you\u0027d like to support, I can of course take the time to supply a patch which includes some documentation along the lines you are suggesting.",
      "parentUuid": "9a92ce04_b9ff668a",
      "range": {
        "startLine": 3059,
        "startChar": 10,
        "endLine": 3059,
        "endChar": 18
      },
      "revId": "0674043364812b5ca998b9457b3f28b41b81967b",
      "serverId": "c360c8e5-7aa8-3905-a7a0-810934766dac"
    }
  ]
}